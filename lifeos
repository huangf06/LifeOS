#!/bin/bash
# LifeOS Personal Assistant å¿«é€Ÿå¯åŠ¨è„šæœ¬

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PYTHON_SCRIPT="$SCRIPT_DIR/scripts/personal_assistant.py"

# æ£€æŸ¥å‚æ•°
if [ $# -eq 0 ]; then
    echo "ğŸ¤– LifeOS Personal Assistant"
    echo ""
    echo "ç”¨æ³•:"
    echo "  lifeos 'your task description'"
    echo "  lifeos stats    # æŸ¥çœ‹ç»Ÿè®¡"
    echo ""
    echo "ç¤ºä¾‹:"
    echo "  lifeos 'æ˜å¤©è¦å¼€ä¼šï¼Œéœ€è¦å‡†å¤‡PPTå’Œä¼šè®®èµ„æ–™'"
    echo "  lifeos 'è¿™å‘¨è¦å®Œæˆé¡¹ç›®æŠ¥å‘Šï¼Œå®‰æ’æ—¶é—´å¤ä¹ è‹±è¯­'"
    exit 1
fi

# ç‰¹æ®Šå‘½ä»¤
case "$1" in
    "setup")
        python3 "$SCRIPT_DIR/scripts/todoist_manager.py" setup
        ;;
    "test")
        python3 "$SCRIPT_DIR/scripts/todoist_manager.py" test
        ;;
    "fitness")
        python3 "$SCRIPT_DIR/scripts/todoist_manager.py" fitness
        ;;
    "init-todoist")
        python3 "$SCRIPT_DIR/scripts/todoist_manager.py" init-projects
        ;;
    "setup-goals")
        python3 "$SCRIPT_DIR/scripts/setup_goals.py" --all
        ;;
    "setup-goal")
        python3 "$SCRIPT_DIR/scripts/setup_goals.py" --goal "$2"
        ;;
    "export-tasks")
        python3 "$SCRIPT_DIR/scripts/todoist_manager.py" export
        ;;
    "list-tasks")
        python3 "$SCRIPT_DIR/scripts/todoist_manager.py" list "$2" "$3"
        ;;
    "quick")
        python3 "$SCRIPT_DIR/scripts/quick_task.py" "$2" "$3" "$4" "$5" "$6"
        ;;
    "stats")
        python3 "$PYTHON_SCRIPT" --stats
        ;;
    # ç”Ÿæ´»è¿½è¸ªå‘½ä»¤
    "log")
        python3 "$SCRIPT_DIR/scripts/logseq_tracker.py" log --category "$2" --content "$3" --rating "$4" --duration "$5"
        ;;
    "data")
        python3 "$SCRIPT_DIR/scripts/logseq_tracker.py" data --type "$2" --value "$3"
        ;;
    "today")
        python3 "$SCRIPT_DIR/scripts/logseq_tracker.py" init
        ;;
    "report")
        python3 "$SCRIPT_DIR/scripts/logseq_tracker.py" report
        ;;
    "sync")
        python3 "$SCRIPT_DIR/scripts/logseq_tracker.py" sync
        ;;
    # AIé¡¾é—®å‘½ä»¤
    "analyze")
        python3 "$SCRIPT_DIR/scripts/ai_advisor.py" analyze
        ;;
    "plan")
        python3 "$SCRIPT_DIR/scripts/ai_advisor.py" plan
        ;;
    "advice")
        python3 "$SCRIPT_DIR/scripts/ai_advisor.py" analyze
        ;;
    # Anki åŒæ­¥å‘½ä»¤
    "sync-anki")
        shift  # ç§»é™¤ sync-anki å‚æ•°
        python3 "$SCRIPT_DIR/scripts/sync_notion_anki.py" "$@"
        ;;
    "setup-anki")
        python3 "$SCRIPT_DIR/scripts/setup_anki_database.py" "$2"
        ;;
    # æ¬§è·¯è¯å…¸åŒæ­¥å‘½ä»¤
    "sync-eudic")
        shift  # ç§»é™¤ sync-eudic å‚æ•°
        python3 "$SCRIPT_DIR/scripts/sync_eudic_notion.py" "$@"
        ;;
    "test-eudic")
        python3 "$SCRIPT_DIR/scripts/sync_eudic_notion.py" --dry-run
        ;;
    "help")
        echo "ğŸ¤– LifeOS Personal Assistant å¸®åŠ©"
        echo ""
        echo "åŸºç¡€å‘½ä»¤ï¼š"
        echo "  lifeos 'task description'  # æ™ºèƒ½ä»»åŠ¡è§„åˆ’"
        echo "  lifeos setup              # è®¾ç½®Todoist API Token"
        echo "  lifeos test               # æµ‹è¯•Todoistè¿æ¥"
        echo "  lifeos init-todoist       # åˆå§‹åŒ–Todoisté¡¹ç›®å’Œæ ‡ç­¾"
        echo "  lifeos setup-goals        # å¿«é€Ÿè®¾ç½®ä¸‰å¤§ç›®æ ‡ï¼ˆå¥èº«/æ±‚èŒ/è‹±è¯­ï¼‰"
        echo "  lifeos setup-goal fitness # è®¾ç½®å•ä¸ªç›®æ ‡"
        echo "  lifeos fitness            # å‘é€å¥èº«è®¡åˆ’"
        echo "  lifeos export-tasks       # å¯¼å‡ºæ‰€æœ‰ä»»åŠ¡æ•°æ®"
        echo "  lifeos list-tasks         # åˆ—å‡ºæ‰€æœ‰ä»»åŠ¡"
        echo "  lifeos quick 'ä»»åŠ¡' 'æ—¶é—´' [é¡¹ç›®] [ä¼˜å…ˆçº§] [æè¿°]  # å¿«é€Ÿåˆ›å»ºä»»åŠ¡"
        echo "  lifeos stats              # æŸ¥çœ‹ä½¿ç”¨ç»Ÿè®¡"
        echo ""
        echo "ç”Ÿæ´»è¿½è¸ªå‘½ä»¤ï¼š"
        echo "  lifeos today              # åˆå§‹åŒ–ä»Šæ—¥è®°å½•æ¨¡æ¿"
        echo "  lifeos log work 'ç¼–ç¨‹2å°æ—¶' 8 '2h'  # è®°å½•æ´»åŠ¨"
        echo "  lifeos data mood 8        # æ›´æ–°å¿ƒæƒ…è¯„åˆ†"
        echo "  lifeos report             # ç”Ÿæˆå‘¨æŠ¥"
        echo "  lifeos sync               # GitåŒæ­¥Logseq"
        echo ""
        echo "AIé¡¾é—®å‘½ä»¤ï¼š"
        echo "  lifeos analyze            # AIåˆ†æç”Ÿæ´»æ¨¡å¼å’Œå»ºè®®"
        echo "  lifeos plan               # ç”Ÿæˆæ˜æ—¥ä¼˜åŒ–è®¡åˆ’"
        echo "  lifeos advice             # è·å–AIç”Ÿæ´»å»ºè®®"
        echo ""
        echo "Anki åŒæ­¥å‘½ä»¤ï¼š"
        echo "  lifeos setup-anki [PAGE_ID]  # åˆ›å»º Anki Cards æ•°æ®åº“"
        echo "  lifeos sync-anki          # åŒæ­¥ Notion åˆ° Anki (ç”Ÿæˆ .apkg)"
        echo "  lifeos sync-anki --dry-run   # è¯•è¿è¡Œï¼ˆä¸ä¿®æ”¹æ•°æ®ï¼‰"
        echo ""
        echo "æ¬§è·¯è¯å…¸åŒæ­¥å‘½ä»¤ï¼š"
        echo "  lifeos sync-eudic         # åŒæ­¥æ¬§è·¯ç”Ÿè¯æœ¬åˆ° Notion (ç„¶åè‡ªåŠ¨åˆ° Anki)"
        echo "  lifeos test-eudic         # æµ‹è¯•æ¬§è·¯è¿æ¥ï¼ˆä¸å†™å…¥æ•°æ®ï¼‰"
        echo "  lifeos sync-eudic --limit 5  # å°æ‰¹é‡æµ‹è¯•ï¼ˆåªåŒæ­¥å‰5ä¸ªå•è¯ï¼‰"
        echo ""
        echo "è¿™æ˜¯ä½ çš„AIä¸ªäººåŠ©ç†ï¼Œå¯ä»¥ï¼š"
        echo "â€¢ ç†è§£ä½ çš„è‡ªç„¶è¯­è¨€æè¿°"
        echo "â€¢ ç”Ÿæˆç»“æ„åŒ–çš„ä»»åŠ¡è®¡åˆ’"
        echo "â€¢ è‡ªåŠ¨å‘é€ä»»åŠ¡åˆ°Todoist"
        echo "â€¢ è·Ÿè¸ªä»»åŠ¡å†å²å’Œç»Ÿè®¡"
        echo "â€¢ å¯¼å‡ºå’Œåˆ†æä»»åŠ¡æ•°æ®"
        echo ""
        echo "ç¤ºä¾‹ï¼š"
        echo "  lifeos 'æ˜å¤©è¦å¼€ä¼šï¼Œéœ€è¦å‡†å¤‡PPTå’Œèµ„æ–™'"
        echo "  lifeos 'è¿™å‘¨å®Œæˆé¡¹ç›®æŠ¥å‘Šï¼Œå®‰æ’å­¦ä¹ æ—¶é—´'"
        echo "  lifeos quick 'å–å¿«é€’' 'today 21:00'"
        echo "  lifeos quick 'å¥èº«' 'every day at 18:00' fitness high"
        ;;
    *)
        python3 "$PYTHON_SCRIPT" "$@"
        ;;
esac