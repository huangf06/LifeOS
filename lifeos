#!/bin/bash
# LifeOS Personal Assistant 快速启动脚本

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PYTHON_SCRIPT="$SCRIPT_DIR/personal_assistant.py"

# 检查参数
if [ $# -eq 0 ]; then
    echo "🤖 LifeOS Personal Assistant"
    echo ""
    echo "用法:"
    echo "  lifeos 'your task description'"
    echo "  lifeos stats    # 查看统计"
    echo ""
    echo "示例:"
    echo "  lifeos '明天要开会，需要准备PPT和会议资料'"
    echo "  lifeos '这周要完成项目报告，安排时间复习英语'"
    exit 1
fi

# 特殊命令
case "$1" in
    "setup")
        python3 "$SCRIPT_DIR/email_sender.py" setup
        ;;
    "test-email")
        python3 "$SCRIPT_DIR/email_sender.py" test
        ;;
    "fitness")
        python3 "$SCRIPT_DIR/email_sender.py" fitness
        ;;
    "stats")
        python3 "$PYTHON_SCRIPT" --stats
        ;;
    # 生活追踪命令
    "log")
        python3 "$SCRIPT_DIR/logseq_tracker.py" log --category "$2" --content "$3" --rating "$4" --duration "$5"
        ;;
    "data")
        python3 "$SCRIPT_DIR/logseq_tracker.py" data --type "$2" --value "$3"
        ;;
    "today")
        python3 "$SCRIPT_DIR/logseq_tracker.py" init
        ;;
    "report")
        python3 "$SCRIPT_DIR/logseq_tracker.py" report
        ;;
    "sync")
        python3 "$SCRIPT_DIR/logseq_tracker.py" sync
        ;;
    # AI顾问命令
    "analyze")
        python3 "$SCRIPT_DIR/ai_advisor.py" analyze
        ;;
    "plan")
        python3 "$SCRIPT_DIR/ai_advisor.py" plan
        ;;
    "advice")
        python3 "$SCRIPT_DIR/ai_advisor.py" analyze
        ;;
    # Obama语音训练命令
    "obama")
        shift
        if [ $# -eq 0 ]; then
            echo "🎙️ Obama语音训练系统"
            echo ""
            echo "用法:"
            echo "  lifeos obama speak '文本' [语气]  # 生成语音"
            echo "  lifeos obama practice file.txt    # 练习会话"
            echo "  lifeos obama progress             # 查看进度"
            echo "  lifeos obama tones                # 查看语气模式"
            echo "  lifeos obama setup                # 设置声音克隆"
            echo ""
            echo "语气模式: inspiring/conversational/serious/storytelling"
            exit 0
        fi
        case "$1" in
            "speak")
                python3 "$SCRIPT_DIR/obama_voice_trainer.py" generate --text "$2" --tone "${3:-conversational}"
                ;;
            "practice")
                python3 "$SCRIPT_DIR/obama_voice_trainer.py" practice --file "$2" --tone "${3:-conversational}"
                ;;
            "progress")
                python3 "$SCRIPT_DIR/obama_voice_trainer.py" progress
                ;;
            "tones")
                python3 "$SCRIPT_DIR/obama_voice_trainer.py" list-tones
                ;;
            "setup")
                python3 "$SCRIPT_DIR/voice_api.py" setup
                ;;
            *)
                echo "❌ 未知命令: $1"
                echo "使用 'lifeos obama' 查看帮助"
                ;;
        esac
        ;;
    "help")
        echo "🤖 LifeOS Personal Assistant 帮助"
        echo ""
        echo "基础命令："
        echo "  lifeos 'task description'  # 智能任务规划"
        echo "  lifeos setup              # 设置邮件账户"
        echo "  lifeos test-email         # 测试邮件发送"
        echo "  lifeos fitness            # 发送健身计划"
        echo "  lifeos stats              # 查看使用统计"
        echo ""
        echo "生活追踪命令："
        echo "  lifeos today              # 初始化今日记录模板"
        echo "  lifeos log work '编程2小时' 8 '2h'  # 记录活动"
        echo "  lifeos data mood 8        # 更新心情评分"
        echo "  lifeos report             # 生成周报"
        echo "  lifeos sync               # Git同步Logseq"
        echo ""
        echo "AI顾问命令："
        echo "  lifeos analyze            # AI分析生活模式和建议"
        echo "  lifeos plan               # 生成明日优化计划"
        echo "  lifeos advice             # 获取AI生活建议"
        echo ""
        echo "Obama语音训练命令："
        echo "  lifeos obama              # 查看语音训练帮助"
        echo "  lifeos obama speak '文本' # 生成奥巴马风格语音"
        echo "  lifeos obama practice     # 开始练习会话"
        echo "  lifeos obama progress     # 查看训练进度"
        echo ""
        echo "这是你的AI个人助理，可以："
        echo "• 理解你的自然语言描述"
        echo "• 生成结构化的任务计划" 
        echo "• 自动发送任务到OmniFocus"
        echo "• 跟踪任务历史和统计"
        echo ""
        echo "示例："
        echo "  lifeos '明天要开会，需要准备PPT和资料'"
        echo "  lifeos '这周完成项目报告，安排学习时间'"
        ;;
    *)
        python3 "$PYTHON_SCRIPT" "$@"
        ;;
esac