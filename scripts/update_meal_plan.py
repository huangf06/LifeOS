#!/usr/bin/env python3
"""
æ›´æ–°è†³é£Ÿè®¡åˆ’åˆ°Todoist - "æ¯æ—¥ä¸€ç½"ç»ˆæé…æ–¹ v4.0
åŸºäºplans/è†³é£Ÿè®¡åˆ’-ç»ˆææ ¸å¿ƒé…æ–¹.md
"""

import sys
from pathlib import Path

# æ·»åŠ è„šæœ¬ç›®å½•åˆ°è·¯å¾„
sys.path.insert(0, str(Path(__file__).parent))

from todoist_manager import TodoistManager


def update_meal_plan():
    """æ›´æ–°è†³é£Ÿè®¡åˆ’ä»»åŠ¡åˆ°Todoist"""
    print("ğŸ½ï¸  æ›´æ–°è†³é£Ÿè®¡åˆ’ - æ¯æ—¥ä¸€ç½ v4.0")
    print("=" * 50)

    manager = TodoistManager()

    if not manager.api:
        print("âŒ Todoist APIæœªåˆå§‹åŒ–")
        print("è¯·å…ˆè¿è¡Œ: ./lifeos setup")
        return False

    # å®šä¹‰æ–°çš„è†³é£Ÿè®¡åˆ’ä»»åŠ¡
    meal_tasks = [
        {
            "content": "ğŸº æ—©ä¸Šå‡†å¤‡\"æ¯æ—¥ä¸€ç½\"è¥å…»æ¶²",
            "project": "fitness",
            "priority": "high",
            "due_days": 0,
            "labels": ["routine", "habit"],
            "description": """ã€ç»ˆææ ¸å¿ƒé…æ–¹ v4.0 - å…¨å¤©å‰‚é‡ã€‘

ğŸ¥› è›‹ç™½è´¨åŸºåº• (202g):
â€¢ ä¹³æ¸…è›‹ç™½ 100g
â€¢ é…ªè›‹ç™½ 100g

ğŸŒ¾ ç¢³æ°´åŸºåº• (237g):
â€¢ å³é£Ÿç‡•éº¦ç²‰ 300g
â€¢ é¦™è•‰ 1æ ¹

ğŸ¥œ å¥åº·è„‚è‚ª (89g):
â€¢ èŠ±ç”Ÿé…± 20g
â€¢ æä»é…± 30g
â€¢ ç ”ç£¨äºšéº»ç±½ç²‰ 30g

ğŸ¥¬ å¾®é‡è¥å…»ç´ :
â€¢ å†·å†»è èœ 150g

ğŸ’§ æ¶²ä½“åŸºåº•:
â€¢ ç‰›å¥¶ 500ml
â€¢ æ°´ 1.5L

ğŸ“ æ‰§è¡Œæ­¥éª¤:
1. å°†æ‰€æœ‰ææ–™æ”¾å…¥å¤§æ…æ‹Œæœº
2. é«˜é€Ÿæ…æ‹Œ60-90ç§’è‡³é¡ºæ»‘
3. å€’å…¥2.5Lå¯†å°å£¶æˆ–2-3ä¸ªæ‘‡æ¯
4. ç«‹å³å†·è—

âš ï¸ æ€»è¥å…»: ~2550 kcal | è›‹ç™½202g | ç¢³æ°´237g | è„‚è‚ª89g"""
        },
        {
            "content": "ğŸ¥¤ æ—©é¤æ—¶æ®µ - é¥®ç”¨1/3è¥å…»æ¶²",
            "project": "fitness",
            "priority": "high",
            "due_days": 0,
            "labels": ["routine"],
            "description": """ä»å†°ç®±å–å‡ºè¥å…»å£¶ï¼Œç”¨åŠ›æ‘‡æ™ƒæ··åˆå‡åŒ€åå€’å‡ºçº¦1/3é¥®ç”¨ã€‚

è¥å…»æ‘„å…¥: ~850 kcal | è›‹ç™½67g | ç¢³æ°´79g | è„‚è‚ª30g

ğŸ’Š åŒæ—¶æœç”¨è¡¥å‰‚:
â€¢ å¤åˆç»´ç”Ÿç´  1ç²’
â€¢ ç»´ç”Ÿç´ D3
â€¢ é±¼æ²¹ (Omega-3)

âš ï¸ é¥®ç”¨åç”¨æ¸…æ°´æ¼±å£ä¿æŠ¤ç‰™é‡‰è´¨"""
        },
        {
            "content": "ğŸ¥¤ åˆé¤æ—¶æ®µ - é¥®ç”¨1/3è¥å…»æ¶² + è‚Œé…¸",
            "project": "fitness",
            "priority": "high",
            "due_days": 0,
            "labels": ["routine"],
            "description": """ä»å†°ç®±å–å‡ºè¥å…»å£¶ï¼Œç”¨åŠ›æ‘‡æ™ƒæ··åˆå‡åŒ€åå€’å‡ºçº¦1/3é¥®ç”¨ã€‚

è¥å…»æ‘„å…¥: ~850 kcal | è›‹ç™½67g | ç¢³æ°´79g | è„‚è‚ª30g

ğŸ’Š åŒæ—¶æœç”¨è¡¥å‰‚:
â€¢ è‚Œé…¸ 5g (å¯ç›´æ¥æ··å…¥è¥å…»æ¶²)

âš ï¸ é¥®ç”¨åç”¨æ¸…æ°´æ¼±å£"""
        },
        {
            "content": "ğŸ¥¤ æ™šé¤/è®­ç»ƒå - å–å®Œæœ€å1/3è¥å…»æ¶²",
            "project": "fitness",
            "priority": "high",
            "due_days": 0,
            "labels": ["routine"],
            "description": """ä»å†°ç®±å–å‡ºè¥å…»å£¶ï¼Œç”¨åŠ›æ‘‡æ™ƒæ··åˆå‡åŒ€åå–å®Œå‰©ä½™éƒ¨åˆ†ã€‚

è¥å…»æ‘„å…¥: ~850 kcal | è›‹ç™½68g | ç¢³æ°´79g | è„‚è‚ª29g

ğŸ’Š åŒæ—¶æœç”¨è¡¥å‰‚:
â€¢ é•è¡¥å‰‚

âš ï¸ é¥®ç”¨åç”¨æ¸…æ°´æ¼±å£

ğŸ“Š ä»Šæ—¥å®Œæˆå…¨å¤©è¥å…»ç›®æ ‡! æ€»è®¡:
â€¢ çƒ­é‡: 2550 kcal
â€¢ è›‹ç™½è´¨: 202g
â€¢ ç¢³æ°´åŒ–åˆç‰©: 237g
â€¢ è„‚è‚ª: 89g"""
        },
        {
            "content": "ğŸ’§ é¢å¤–é¥®æ°´ - å…¨å¤©2-3Læ¸…æ°´",
            "project": "fitness",
            "priority": "medium",
            "due_days": 0,
            "labels": ["routine"],
            "description": """é™¤é…æ–¹ä¸­çš„æ¶²ä½“(ç‰›å¥¶500ml+æ°´1.5L)å¤–ï¼Œå…¨å¤©è¿˜éœ€é¢å¤–é¥®ç”¨2-3å‡æ¸…æ°´ã€‚

å»ºè®®åˆ†é…:
â€¢ èµ·åºŠå: 500ml
â€¢ ä¸Šåˆ: 500ml
â€¢ ä¸‹åˆ: 500ml
â€¢ è®­ç»ƒä¸­: 500ml
â€¢ æ™šä¸Š: 500ml

ğŸ’¡ ä¿æŒèº«ä½“å……åˆ†æ°´åˆï¼Œä¼˜åŒ–è¥å…»å¸æ”¶å’Œè®­ç»ƒè¡¨ç°"""
        }
    ]

    print("\nğŸ“ åˆ›å»ºæ–°çš„è†³é£Ÿä»»åŠ¡...")
    created_count = 0

    for task_data in meal_tasks:
        content = task_data.pop("content")
        print(f"\nåˆ›å»º: {content}")

        task = manager.create_task(content, **task_data)

        if task:
            print(f"  âœ… æˆåŠŸ (ID: {task.id})")
            created_count += 1
        else:
            print(f"  âŒ å¤±è´¥")

    print("\n" + "=" * 50)
    print(f"âœ… å®Œæˆï¼æˆåŠŸåˆ›å»º {created_count}/{len(meal_tasks)} ä¸ªä»»åŠ¡")
    print("\nğŸ“± è¯·åˆ°TodoistæŸ¥çœ‹æ–°çš„è†³é£Ÿè®¡åˆ’ä»»åŠ¡")
    print("ğŸ’¡ æç¤º: æ—§çš„å¤šé¤ä»»åŠ¡å¯ä»¥æ‰‹åŠ¨åˆ é™¤æˆ–å®Œæˆ")

    return True


if __name__ == "__main__":
    update_meal_plan()
